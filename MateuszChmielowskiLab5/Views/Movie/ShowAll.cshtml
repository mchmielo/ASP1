@model List<MateuszChmielowskiLab5.Models.Movie>

@{
    ViewBag.Title = "ShowAll";
}
@Html.Partial("~/Views/Movie/_AddNewMovieModal.cshtml", new MateuszChmielowskiLab5.Models.Movie() { })
<button id="add_new_movie_button" class="btn btn-success">Dodaj nowy film</button>
<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th class="col-md-1">Id</th>
                <th class="col-md-5">Nazwa</th>
                <th class="col-md-3">Data premiery</th>
                <th class="col-md-3">Akcje</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < Model.Count; i++)
            {
                <tr id="@Model[i].Id">
                    <td><b>@Model[i].Id</b></td>
                    <td><b>@Model[i].Name</b></td>
                    <td><b>@Model[i].ReleaseDate.ToShortDateString()</b></td>
                    <td>
                        <button id="edit-@Model[i].Id" class="btn btn-primary edit">Edytuj</button>
                        <button id="delete-@Model[i].Id"  class="btn btn-danger delete">Usuń</button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        //obsługa przycisku delete
        $(".delete").on("click", function () {
            var id = $(this).prop('id').substring(7);
            $.ajax({
                url: "/Movie/DeleteById",
                type: "POST",
                data: { movieId: id },
                success: function () {
                    $("#" + id).remove();
                },
                error: function (data) {
                    console.error(data);
                }
            });
        });
        $("#add_new_movie_button").on("click", function () {
            $("#add_movie_modal").modal('show');
        });
    });
</script>